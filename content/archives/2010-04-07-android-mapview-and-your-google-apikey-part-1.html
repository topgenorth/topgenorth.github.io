---
date: "2010-04-07T00:00:00Z"
meta:
  _edit_last: "2"
published: true
status: publish
categories:
- Programming
tags:
- android
title: 'Android, MapView, and your Google apiKey: Part 1'
type: post
---
<p><a href="http://www.opgenorth.net/wp-content/uploads/2010/04/MapList1.png"><img style="display: inline; margin-left: 10px; margin-right: 0px" title="MapList" border="0" alt="MapList" align="right" src="http://www.opgenorth.net/wp-content/uploads/2010/04/MapList_thumb1.png" width="164" height="244" /></a></p>  <p>Thanks to the <a href="http://developer.android.com/guide/tutorials/views/hello-mapview.html">MapView</a>, itâ€™s drop dead easy to put Google Maps into your application.&#160; There are lots of posts out there how to do it.&#160; Interestingly (to me anyway), when I did a quick search of the Android developers mailing list, I was surprised to see that a lot of people had the same problem:&#160; basically, when you look at your MapView, you end up with a grid of white squares.&#160; It kind of sucks.&#160; There are a lot of blog posts and articles out there on how to fix this problem, but this one is for me, and to help me remember it.</p>  <p>The trick to fixing this is setting your Google Maps API key.&#160; Note the layout below:</p>  <div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 76.6%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; height: 210px; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">   <div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">     <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">&lt;?</span><span style="color: #800000">xml</span> <span style="color: #ff0000">version</span><span style="color: #0000ff">=&quot;1.0&quot;</span> <span style="color: #ff0000">encoding</span><span style="color: #0000ff">=&quot;utf-8&quot;</span>?<span style="color: #0000ff">&gt;</span></pre>

    <p>
      <br /><!--CRLF-->

      <br /></p>

    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum2">   2:</span> <span style="color: #0000ff">&lt;</span><span style="color: #800000">RelativeLayout</span> <span style="color: #ff0000">xmlns:android</span><span style="color: #0000ff">=&quot;http://schemas.android.com/apk/res/android&quot;</span></pre>

    <p>
      <br /><!--CRLF-->

      <br /></p>

    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum3">   3:</span>     <span style="color: #ff0000">android:id</span><span style="color: #0000ff">=&quot;@+id/mainlayout&quot;</span></pre>

    <p>
      <br /><!--CRLF-->

      <br /></p>

    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum4">   4:</span>     <span style="color: #ff0000">android:orientation</span><span style="color: #0000ff">=&quot;vertical&quot;</span></pre>

    <p>
      <br /><!--CRLF-->

      <br /></p>

    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum5">   5:</span>     <span style="color: #ff0000">android:layout_width</span><span style="color: #0000ff">=&quot;fill_parent&quot;</span></pre>

    <p>
      <br /><!--CRLF-->

      <br /></p>

    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum6">   6:</span>     <span style="color: #ff0000">android:layout_height</span><span style="color: #0000ff">=&quot;fill_parent&quot;</span> <span style="color: #0000ff">&gt;</span></pre>

    <p>
      <br /><!--CRLF-->

      <br /></p>

    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum7">   7:</span></pre>

    <p>
      <br /><!--CRLF-->

      <br /></p>

    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum8">   8:</span>     <span style="color: #0000ff">&lt;</span><span style="color: #800000">com.google.android.maps.MapView</span></pre>

    <p>
      <br /><!--CRLF-->

      <br /></p>

    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum9">   9:</span>         android:id=&quot;@+id/mapview&quot;</pre>

    <p>
      <br /><!--CRLF-->

      <br /></p>

    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum10">  10:</span>         android:layout_width=&quot;fill_parent&quot;</pre>

    <p>
      <br /><!--CRLF-->

      <br /></p>

    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum11">  11:</span>         android:layout_height=&quot;fill_parent&quot;</pre>

    <p>
      <br /><!--CRLF-->

      <br /></p>

    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum12">  12:</span>         android:clickable=&quot;true&quot;</pre>

    <p>
      <br /><!--CRLF-->

      <br /></p>

    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum13">  13:</span>         android:apiKey=&quot;Your Maps API Key&quot;</pre>

    <p>
      <br /><!--CRLF-->

      <br /></p>

    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum14">  14:</span>     <span style="color: #0000ff">/&gt;</span></pre>

    <p>
      <br /><!--CRLF-->

      <br /></p>

    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum15">  15:</span></pre>

    <p>
      <br /><!--CRLF-->

      <br /></p>

    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum16">  16:</span> <span style="color: #0000ff">&lt;/</span><span style="color: #800000">RelativeLayout</span><span style="color: #0000ff">&gt;</span></pre>

    <p><!--CRLF--></p>
  </div>
</div>

<p><a href="http://www.opgenorth.net/wp-content/uploads/2010/04/hotelkey.jpg"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; margin-left: 0px; border-left-width: 0px; margin-right: 0px" title="hotel-key" border="0" alt="hotel-key" align="left" src="http://www.opgenorth.net/wp-content/uploads/2010/04/hotelkey_thumb.jpg" width="71" height="63" /></a></p>

<p>In particular, pay attention to line #13.&#160; What you have to do is create a Google Maps API key, and then paste it in there.&#160; Thatâ€™s simple.&#160; How do you do that?&#160; Well itâ€™s simple too, but not as simple as it could be.&#160; The first thing you need to do is to <a href="http://developer.android.com/guide/publishing/app-signing.html">sign your application</a>.&#160; This isnâ€™t a big deal, you have to sign your application before you can publish it anyway.&#160; Android will NOT install an application otherwise.</p>

<p>So, it seems we have two steps here:</p>

<ol>
  <li>Sign your application </li>

  <li>Use your signed application to get a Google Maps apiKey. </li>
</ol>

<p>Generate a private key.&#160; Keep this safer, as if it were the Holy Grail.&#160; Lose this, and as far as the public is concerned, youâ€™re locked out from your own application â€“ you will not be able to update it.&#160; The image below will show you the steps to go through</p>

<ol>
  <pre class="csharpcode"><span class="str">&quot;C:\Program Files (x86)\Java\jdk1.6.0_19\bin\keytool&quot;</span> -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -validity 10000</pre>
</ol>

<p><a href="http://www.opgenorth.net/wp-content/uploads/2010/04/keytoolsample1.png"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="keytoolsample" border="0" alt="keytoolsample" src="http://www.opgenorth.net/wp-content/uploads/2010/04/keytoolsample_thumb1.png" width="594" height="309" /></a></p>

<p>Once you have that done, build your application (in release mode).&#160; I leave this as an exercise for the reader.</p>

<p>Now that you have your application built, you need to sign it.&#160; This is where jarsigner comes in:</p>

<p><!-- .csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } --><a href="http://www.opgenorth.net/wp-content/uploads/2010/04/jarsigner1.png"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="jarsigner" border="0" alt="jarsigner" src="http://www.opgenorth.net/wp-content/uploads/2010/04/jarsigner_thumb1.png" width="513" height="267" /></a>And the final step is to zipalign your&#160; APK.&#160; You have to do zipalign last.&#160; Basically, you do zipalign for performance reasons.&#160; If you want to know more, RTFM.</p>

<pre class="csharpcode">C:\android-sdk-windows\tools\zipalign -v 4 HistoricalBuildings-unalign.apk HistoricalBuildings.apk</pre>

<p><!-- .csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } --><a href="http://www.opgenorth.net/wp-content/uploads/2010/04/zipalign1.png"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="zipalign" border="0" alt="zipalign" src="http://www.opgenorth.net/wp-content/uploads/2010/04/zipalign_thumb1.png" width="513" height="267" /></a></p>

<p>Now, of course, both Eclipse and IntelliJ will handle these steps for you.&#160; But where is the fun in that?</p>
