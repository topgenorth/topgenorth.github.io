--- 
layout: post
title: On Stored Procedures
tags: []

status: publish
type: post
published: true
meta: {}

---
<p>Yesterday myself, <a href="http://www.igloocoder.com">Don</a>, <a href="http://geekswithblogs.net/dlussier/Default.aspx">D'Arcy</a>, and Eric were wandering around Seattle, just checking out the sights after the MVP Summit.&#160; We took a break from the usual &quot;run down D'Arcy and Manitoba&quot; shtick, and actually had a serious conversation on the relevance of stored procedures for your typical database development/line of business app.&#160; D'Arcy <a href="http://geekswithblogs.net/dlussier/archive/2008/04/18/121341.aspx">blogged</a> take on it already.&#160; I was going to reply in his comments, but as the comments grew, I figured my own post was in order.</p>  <p>I wouldn't go quite so far as to say that sprocs are obsolete, but I really don't think that they are that important anymore.&#160; Sure, there will be certain circumstances where you need stored procs:&#160; reporting comes to mind, or maybe you need to to some really DB specific things.</p>  <p>However, for a lot of your day to day CRUD, you don't need stored procs.&#160; Use an ORM.&#160; I use <a href="http://www.nhibernate.org">NHibernate</a>, and as such will be speaking from that point of view.</p>  <p><a href="http://www.opgenorth.net/wp-content/uploads/2010/03/obsolete_2.jpg"><img style="border-bottom: 0px; border-left: 0px; display: inline; margin-left: 0px; border-top: 0px; margin-right: 0px; border-right: 0px" title="obsolete_2" border="0" alt="obsolete_2" align="left" src="http://www.opgenorth.net/wp-content/uploads/2010/03/obsolete_2_thumb.jpg" width="172" height="244" /></a> To support your typical CRUD for a table, you usually need at least our stored procs:&#160; Insert, Update, Delete, and Find.&#160; Usually it's more - a lot more because of querying concerns.&#160; These have to be maintained, and versioned, and kept in sync with the application.&#160; This is friction.&#160; Using NHibernate, you have a mapping file per table that is typically embedded in your assembly as a resource.&#160; This is frictionless (relative to stored procs).</p>  <p>It will be said that stored procs provide you with a single API for your database which will shield your application for DB changes.&#160; Here, I don't agree.&#160; A lot of times if you're making drastic changes like this to the database, you're probably making changes to your application.&#160; You're probably going to be recompiling and sending out new binaries and new stored procs.</p>  <p>Now, I'm sure that everybody in the stored proc camp is loading up their <a href="http://en.wikipedia.org/wiki/Blunderbuss">blunderbusses</a> full of &quot;stored procs are faster&quot; shot and getting ready to fire a volley.&#160; And, I'm sure that they have the &quot;dynamic SQL is insecure&quot; ammo in easy reach for the second volley.&#160; This is not true.&#160; NHibernate creates parameterized queries - parameterized queries are just as fast as stored procs.&#160; And, because these are parameterized queries, they are just as secure as stored procs (<i>edit:&#160; by secure, I mean resistant to injection attacks and the like</i>).</p>  <p>Another point to consider is this:&#160; most programmers are not DBA's.&#160; Their proficiency is in writing code (C#, VB.NET).&#160; Keep your programmers doing what they do best: coding in the language they are most proficient in.&#160; I don't want to say that programmers write bad SQL, but that NHibernate will probably create the SQL statements that are just as good (or better) than what a programmer will do.&#160; There isn't just one database driver in NHibernate churning out generic SQL for all database platforms.&#160; The database drivers are very specialized modules that are optimized for the database in question (i.e. MySQL, Oracle, SQL Server 2000, SQL Server 2005).</p>  <p>Honestly though, this debate (ORM vs stored procs) has been going on for while.&#160; I know that there are still many places that are firmly entrenched and will only use stored procs.&#160; So, to say that stored procs are obsolete might be a bit harsh.&#160; I do believe that they aren't as relevant anymore.</p>
